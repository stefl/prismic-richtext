!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("PrismicRichtext",[],e):"object"==typeof exports?exports.PrismicRichtext=e():t.PrismicRichtext=e()}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=24)}([function(t,e,n){var r=n(1),o=n(3);t.exports=function(t){return function e(n,i){switch(arguments.length){case 0:return e;case 1:return o(n)?e:r(function(e){return t(n,e)});default:return o(n)&&o(i)?e:o(n)?r(function(e){return t(e,i)}):o(i)?r(function(e){return t(n,e)}):t(n,i)}}}},function(t,e,n){var r=n(3);t.exports=function(t){return function e(n){return 0===arguments.length||r(n)?e:t.apply(this,arguments)}}},function(t,e,n){"use strict";var r;e.__esModule=!0,e.NODE_TYPES={heading1:"heading1",heading2:"heading2",heading3:"heading3",heading4:"heading4",heading5:"heading5",heading6:"heading6",paragraph:"paragraph",preformatted:"preformatted",strong:"strong",em:"em",listItem:"list-item",oListItem:"o-list-item",list:"group-list-item",oList:"group-o-list-item",image:"image",embed:"embed",hyperlink:"hyperlink",label:"label",span:"span"},e.PRIORITIES=((r={})[e.NODE_TYPES.heading1]=4,r[e.NODE_TYPES.heading2]=4,r[e.NODE_TYPES.heading3]=4,r[e.NODE_TYPES.heading4]=4,r[e.NODE_TYPES.heading5]=4,r[e.NODE_TYPES.heading6]=4,r[e.NODE_TYPES.paragraph]=3,r[e.NODE_TYPES.preformatted]=5,r[e.NODE_TYPES.strong]=6,r[e.NODE_TYPES.em]=6,r[e.NODE_TYPES.oList]=1,r[e.NODE_TYPES.list]=1,r[e.NODE_TYPES.listItem]=1,r[e.NODE_TYPES.oListItem]=1,r[e.NODE_TYPES.image]=1,r[e.NODE_TYPES.embed]=1,r[e.NODE_TYPES.hyperlink]=3,r[e.NODE_TYPES.label]=4,r[e.NODE_TYPES.span]=7,r)},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}},function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});e.__esModule=!0;var i=n(5),u=n(2),c=function(){return function(t,e,n){this.key=i.default(),this.type=t,this.element=e,this.children=n}}();e.Node=c;var a=function(t){function e(e,n,r,o,i,u){var c=t.call(this,r,u,i)||this;return c.start=e,c.end=n,c.text=o,c.children=i,c}return o(e,t),e.prototype.boundaries=function(){return{lower:this.start,upper:this.end}},e.prototype.isParentOf=function(t){return this.start<=t.start&&this.end>=t.end},e.prototype.setChildren=function(t){return new e(this.start,this.end,this.type,this.text,t,this.element)},e.slice=function(t,n,r,o){return new e(n,r,t.type,o.slice(n,r),t.children,t.element)},e}(c);e.SpanNode=a;var s=function(t){function e(e,n,r){var o={type:u.NODE_TYPES.span,start:e,end:n,text:r};return t.call(this,e,n,u.NODE_TYPES.span,r,[],o)||this}return o(e,t),e}(a);e.TextNode=s;var f=function(t){function e(e,n,r){return void 0===r&&(r=[]),t.call(this,e,n,r)||this}return o(e,t),e}(c);e.BlockNode=f;var l=function(t){function e(e,n){return t.call(this,u.NODE_TYPES.listItem,e,n)||this}return o(e,t),e}(f);e.ListItemBlockNode=l;var d=function(t){function e(e,n){return t.call(this,u.NODE_TYPES.oListItem,e,n)||this}return o(e,t),e}(f);e.OrderedListItemBlockNode=d;var p=function(t){function e(e,n){return t.call(this,u.NODE_TYPES.oList,e,n)||this}return o(e,t),e.prototype.addChild=function(t){var n=this.children.concat(t);return new e(this.element,n)},e}(f);e.OrderedListBlockNode=p;var h=function(t){function e(e,n){return t.call(this,u.NODE_TYPES.list,e,n)||this}return o(e,t),e.prototype.addChild=function(t){var n=this.children.concat(t);return new e(this.element,n)},e}(f);e.ListBlockNode=h},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}},function(t,e){t.exports=function(t){return"[object String]"===Object.prototype.toString.call(t)}},function(t,e){t.exports=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(21),o=n(18),i=n(14),u=n(12),c=n(11),a=n(5),s=n(10),f=n(2),l=n(4);function d(t,e){var n=e.others.reduce(function(n,r){var o=n.inner,i=n.outer,u=function(t,e,n){return n.start<e.start?{inner:l.SpanNode.slice(n,e.start,n.end,t),outer:l.SpanNode.slice(n,n.start,e.start,t)}:n.end>e.end?{inner:l.SpanNode.slice(n,n.start,e.end,t),outer:l.SpanNode.slice(n,e.end,n.end,t)}:{inner:n}}(t,e.elected,r);return{inner:o.concat(u.inner),outer:u.outer?i.concat(u.outer):i}},{inner:[],outer:[]}),r=n.inner,o=n.outer;return[e.elected.setChildren(x(t,r,e.elected.boundaries()))].concat(y(t,o))}function p(t){return function(t,e){return e.reduce(function(e,n){var r=i(e);if(r){if(r.some(function(t){return t.isParentOf(n)}))return o(e).concat([r.concat(n)]);var u=i(r);return u&&t(u,n)?o(e).concat([r.concat(n)]):e.concat([[n]])}return[[n]]},[])}(function(t,e){return t.end>=e.start},u([function(t,e){return t.start-e.start},function(t,e){return t.end-e.end}],t))}function h(t){if(0===t.length)throw new Error("Unable to elect node on empty list");var e=t.sort(function(t,e){if(t.isParentOf(e))return-1;if(e.isParentOf(t))return 1;var n=f.PRIORITIES[t.type]-f.PRIORITIES[e.type];return 0===n?t.text.length-e.text.length:n});return{elected:e[0],others:e.slice(1)}}function x(t,e,n){if(e.length>0)return function(t,e,n){return e.reduce(function(r,o,i){var u=[],c=0===i&&o.start>n.lower,a=i===e.length-1&&n.upper>o.end;if(c){var s=new l.TextNode(n.lower,o.start,t.slice(n.lower,o.start));u=u.concat(s)}else{var f=e[i-1];if(f&&o.start>f.end){var d=t.slice(f.end,o.start);s=new l.TextNode(f.end,o.start,d),u=u.concat(s)}}return u=u.concat(o),a&&(s=new l.TextNode(o.end,n.upper,t.slice(o.end,n.upper)),u=u.concat(s)),r.concat(u)},[])}(t,y(t,e),n);var r=t.slice(n.lower,n.upper);return[new l.TextNode(n.lower,n.upper,r)]}function y(t,e){var n=p(c(function(t){return t.start},e)).map(h),o=r(n.map(function(e){return d(t,e)}));return c(function(t){return t.start},o)}var E=function(){function t(){}return t.fromRichText=function(t){return{key:a.default(),children:t.reduce(function(t,e,n){if(s.RichTextBlock.isEmbedBlock(e.type)||s.RichTextBlock.isImageBlock(e.type))return t.concat(new l.BlockNode(e.type,e));var r=function(t){var e=t.spans.map(function(e){var n=t.text.slice(e.start,e.end);return new l.SpanNode(e.start,e.end,e.type,n,[],e)}),n={lower:0,upper:t.text.length};return x(t.text,e,n)}(e),i=t[t.length-1];if(s.RichTextBlock.isListItem(e.type)&&i&&i instanceof l.ListBlockNode){var u=new l.ListItemBlockNode(e,r),c=i.addChild(u);return o(t).concat(c)}if(s.RichTextBlock.isOrderedListItem(e.type)&&i&&i instanceof l.OrderedListBlockNode){var a=new l.OrderedListItemBlockNode(e,r);c=i.addChild(a);return o(t).concat(c)}if(s.RichTextBlock.isListItem(e.type)){u=new l.ListItemBlockNode(e,r);var f=new l.ListBlockNode(s.RichTextBlock.emptyList(),[u]);return t.concat(f)}if(s.RichTextBlock.isOrderedListItem(e.type)){a=new l.OrderedListItemBlockNode(e,r);var d=new l.OrderedListBlockNode(s.RichTextBlock.emptyOrderedList(),[a]);return t.concat(d)}return t.concat(new l.BlockNode(e.type,e,r))},[])}},t.NODE_TYPES=f.NODE_TYPES,t}();e.default=E},function(t,e,n){"use strict";e.__esModule=!0;var r=n(8),o=n(4);e.default=function(t,e,n){return r.default.fromRichText(t).children.map(function(t,r){return function(t,e,n,r){return function t(n,i){var u=n instanceof o.SpanNode?n.text:null,c=n.children.reduce(function(e,n,r){return e.concat([t(n,r)])},[]),a=r&&r(n.type,n.element,u,c,i);return a||e(n.type,n.element,u,c,i)}(t,n)}(t,e,r,n)})}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(2),o=function(){function t(t,e,n){this.type=t,this.text=e,this.spans=n}return t.isEmbedBlock=function(t){return t===r.NODE_TYPES.embed},t.isImageBlock=function(t){return t===r.NODE_TYPES.image},t.isList=function(t){return t===r.NODE_TYPES.list},t.isOrderedList=function(t){return t===r.NODE_TYPES.oList},t.isListItem=function(t){return t===r.NODE_TYPES.listItem},t.isOrderedListItem=function(t){return t===r.NODE_TYPES.oListItem},t.emptyList=function(){return{type:r.NODE_TYPES.list,spans:[],text:""}},t.emptyOrderedList=function(){return{type:r.NODE_TYPES.oList,spans:[],text:""}},t}();e.RichTextBlock=o},function(t,e,n){var r=n(0)(function(t,e){return Array.prototype.slice.call(e,0).sort(function(e,n){var r=t(e),o=t(n);return r<o?-1:r>o?1:0})});t.exports=r},function(t,e,n){var r=n(0)(function(t,e){return Array.prototype.slice.call(e,0).sort(function(e,n){for(var r=0,o=0;0===r&&o<t.length;)r=t[o](e,n),o+=1;return r})});t.exports=r},function(t,e,n){var r=n(0),o=n(6),i=r(function(t,e){var n=t<0?e.length+t:t;return o(e)?e.charAt(n):e[n]});t.exports=i},function(t,e,n){var r=n(13)(-1);t.exports=r},function(t,e,n){var r=n(1),o=n(0),i=n(3);t.exports=function(t){return function e(n,u,c){switch(arguments.length){case 0:return e;case 1:return i(n)?e:o(function(e,r){return t(n,e,r)});case 2:return i(n)&&i(u)?e:i(n)?o(function(e,n){return t(e,u,n)}):i(u)?o(function(e,r){return t(n,e,r)}):r(function(e){return t(n,u,e)});default:return i(n)&&i(u)&&i(c)?e:i(n)&&i(u)?o(function(e,n){return t(e,n,c)}):i(n)&&i(c)?o(function(e,n){return t(e,u,n)}):i(u)&&i(c)?o(function(e,r){return t(n,e,r)}):i(n)?r(function(e){return t(e,u,c)}):i(u)?r(function(e){return t(n,e,c)}):i(c)?r(function(e){return t(n,u,e)}):t(n,u,c)}}}},function(t,e,n){var r=n(7);t.exports=function(t,e){return function(){var n=arguments.length;if(0===n)return e();var o=arguments[n-1];return r(o)||"function"!=typeof o[t]?e.apply(this,arguments):o[t].apply(o,Array.prototype.slice.call(arguments,0,n-1))}}},function(t,e,n){var r=n(16),o=n(15)(r("slice",function(t,e,n){return Array.prototype.slice.call(n,t,e)}));t.exports=o},function(t,e,n){var r=n(17)(0,-1);t.exports=r},function(t,e,n){var r=n(1),o=n(7),i=n(6),u=r(function(t){return!!o(t)||!!t&&("object"==typeof t&&(!i(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))});t.exports=u},function(t,e,n){var r=n(19);t.exports=function(t){return function e(n){for(var o,i,u,c=[],a=0,s=n.length;a<s;){if(r(n[a]))for(u=0,i=(o=t?e(n[a]):n[a]).length;u<i;)c[c.length]=o[u],u+=1;else c[c.length]=n[a];a+=1}return c}}},function(t,e,n){var r=n(1)(n(20)(!0));t.exports=r},function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){var n="string"==typeof e?e:" ";return t.map(function(t){return t.text}).join(n)}},function(t,e,n){"use strict";e.__esModule=!0;var r=n(22),o=n(8),i=n(9);t.exports={asText:r.default,asTree:o.default.fromRichText,serialize:i.default,Elements:o.default.NODE_TYPES}},function(t,e,n){t.exports=n(23)}])});